name: test-all-configurations
run-name: ${{ github.actor }} builds and tests RGL in docker
on: [workflow_dispatch, push]
concurrency: RGL-CI
permissions:
      contents: read
jobs:
  checkout-repository:
    runs-on: self-hosted
    steps:
      - name: Check out repository code
        uses: actions/checkout@v3

  test-all-configurations:
    needs: checkout-repository
    runs-on: self-hosted
    steps:
      - name: test base
        uses: ./.github/workflows/build-RGL-and-test.yml
        with:
            RGL_BUILD_TARGET: base
    #   - name: test with-pcl
    #     uses: ./.github/workflows/build-RGL-and-test.yml
    #     with:
    #         RGL_BUILD_TARGET: with-pcl
      - name: test with-ros2
        uses: ./.github/workflows/build-RGL-and-test.yml
        with:
            RGL_BUILD_TARGET: with-ros2
    #   - name: test with-pcl-and-ros2
    #     uses: ./.github/workflows/build-RGL-and-test.yml
    #     with:
    #         RGL_BUILD_TARGET: with-pcl-and-ros2
      